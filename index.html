<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>제주 공항근처 맛집 지도</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>제주 공항근처 맛집 지도</h1>
            <p>Google Sheets에서 음식점 정보를 불러와 지도에 표시합니다</p>
        </header>
        
        <div class="controls">
            <button id="loadDataBtn" class="btn-primary">데이터 불러오기</button>
            <div class="info">
                <span id="restaurantCount">0개의 음식점</span>
            </div>
            <div class="legend">
                <span class="legend-title">매출 4분위 범례:</span>
                <span class="legend-item">데이터 로드 후 표시됩니다</span>
            </div>
        </div>
        
        <div id="map" class="map-container"></div>
        
        <div id="infoPanel" class="info-panel">
            <h3>음식점 정보</h3>
            <div id="restaurantInfo"></div>
        </div>
    </div>
    
    <!-- 환경 변수 설정 (빌드 시 자동 생성) -->
    <script src="config.js"></script>
    <!-- Google Maps API -->
    <script>
        // config.js에서 API 키를 읽어와 동적으로 로드
        (function() {
            const apiKey = window.APP_CONFIG?.GOOGLE_MAPS_API_KEY || '';
            if (!apiKey || apiKey === 'YOUR_GOOGLE_MAPS_API_KEY') {
                console.error('❌ Google Maps API 키가 설정되지 않았습니다. 환경 변수를 확인해주세요.');
                document.body.innerHTML = '<div style="padding: 20px; text-align: center;"><h2>설정 오류</h2><p>Google Maps API 키가 설정되지 않았습니다.<br>환경 변수 GOOGLE_MAPS_API_KEY를 확인해주세요.</p></div>';
                return;
            }
            
            // Google Maps API 로드 완료 콜백 함수 설정
            window.initGoogleMaps = function() {
                // API 로드 완료 후 app.js의 initMap 호출
                if (typeof initMap === 'function') {
                    initMap();
                }
            };
            
            const script = document.createElement('script');
            // loading=async 파라미터 추가 및 callback 설정
            script.src = `https://maps.googleapis.com/maps/api/js?key=${apiKey}&libraries=places&loading=async&callback=initGoogleMaps`;
            script.async = true;
            script.defer = true;
            script.onerror = function() {
                console.error('❌ Google Maps API를 로드할 수 없습니다.');
                document.body.innerHTML = '<div style="padding: 20px; text-align: center;"><h2>로드 오류</h2><p>Google Maps API를 로드할 수 없습니다.<br>네트워크 연결과 API 키를 확인해주세요.</p></div>';
            };
            document.head.appendChild(script);
        })();
    </script>
    <script src="app.js"></script>
</body>
</html>

